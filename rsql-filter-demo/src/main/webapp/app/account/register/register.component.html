<div class="bg-surface-0 dark:bg-surface-900 p-6 shadow rounded-border w-full">
  <div class="text-center mb-8">
    <div class="text-surface-900 dark:text-surface-0 text-3xl font-medium mb-4" data-cy="registerTitle" appTranslate="register.title">
      Registration
    </div>

    @if (success()) {
      <div class="text-surface-600 dark:text-surface-200 font-medium leading-normal" appTranslate="register.messages.success">
        <strong>Registration saved!</strong> Please check your email for confirmation.
      </div>
    }

    @if (error()) {
      <div class="text-surface-600 dark:text-surface-200 font-medium leading-normal" appTranslate="register.messages.error.fail">
        <strong>Registration failed!</strong> Please try again later.
      </div>
    }

    @if (errorUserExists()) {
      <div class="text-surface-600 dark:text-surface-200 font-medium leading-normal" appTranslate="register.messages.error.userexists">
        <strong>Login name already registered!</strong> Please choose another one.
      </div>
    }

    @if (errorEmailExists()) {
      <div class="text-surface-600 dark:text-surface-200 font-medium leading-normal" appTranslate="register.messages.error.emailexists">
        <strong>Email is already in use!</strong> Please choose another one.
      </div>
    }

    @if (doNotMatch()) {
      <div class="text-surface-600 dark:text-surface-200 font-medium leading-normal" appTranslate="global.messages.error.dontmatch">
        The password and its confirmation do not match!
      </div>
    }
  </div>

  <div class="mb-4" style="width: 400px">
    @if (!success()) {
      <form name="form" role="form" (ngSubmit)="register()" [formGroup]="registerForm">
        <div class="mb-4">
          <label class="block text-surface-900 dark:text-surface-0 font-medium mb-2" for="login" appTranslate="global.form.username.label">
            Username
          </label>
          <input
            pInputText
            type="text"
            class="w-full"
            id="login"
            name="login"
            placeholder="{{ 'global.form.username.placeholder' | translate }}"
            formControlName="login"
            data-cy="username"
            #login
            autocomplete="username"
          />

          @if (registerForm.get('login')!.invalid && (registerForm.get('login')!.dirty || registerForm.get('login')!.touched)) {
            <div>
              @if (registerForm.get('login')?.errors?.required) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="register.messages.validate.login.required"
                  >Your username is required.</small
                >
              }

              @if (registerForm.get('login')?.errors?.minlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="register.messages.validate.login.minlength"
                  >Your username is required to be at least 1 character.</small
                >
              }

              @if (registerForm.get('login')?.errors?.maxlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="register.messages.validate.login.maxlength"
                  >Your username cannot be longer than 50 characters.</small
                >
              }

              @if (registerForm.get('login')?.errors?.pattern) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="register.messages.validate.login.pattern"
                  >Your username is invalid.</small
                >
              }
            </div>
          }
        </div>

        <div class="mb-4">
          <label class="block text-surface-900 dark:text-surface-0 font-medium mb-2" for="email" appTranslate="global.form.email.label">
            Email
          </label>
          <input
            pInputText
            type="email"
            class="w-full"
            id="email"
            name="email"
            placeholder="{{ 'global.form.email.placeholder' | translate }}"
            formControlName="email"
            data-cy="email"
            autocomplete="email"
          />

          @if (registerForm.get('email')!.invalid && (registerForm.get('email')!.dirty || registerForm.get('email')!.touched)) {
            <div>
              @if (registerForm.get('email')?.errors?.required) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.email.required"
                  >Your email is required.</small
                >
              }

              @if (registerForm.get('email')?.errors?.invalid) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.email.invalid"
                  >Your email is invalid.</small
                >
              }

              @if (registerForm.get('email')?.errors?.minlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.email.minlength"
                  >Your email is required to be at least 5 characters.</small
                >
              }

              @if (registerForm.get('email')?.errors?.maxlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.email.maxlength"
                  >Your email cannot be longer than 50 characters.</small
                >
              }
            </div>
          }
        </div>

        <div class="mb-4">
          <label
            class="block text-surface-900 dark:text-surface-0 font-medium mb-2"
            for="password"
            appTranslate="global.form.newpassword.label"
            >New password
          </label>
          <input
            pInputText
            type="password"
            class="w-full"
            id="password"
            name="password"
            placeholder="{{ 'global.form.newpassword.placeholder' | translate }}"
            formControlName="password"
            data-cy="firstPassword"
            autocomplete="new-password"
          />

          @if (registerForm.get('password')!.invalid && (registerForm.get('password')!.dirty || registerForm.get('password')!.touched)) {
            <div>
              @if (registerForm.get('password')?.errors?.required) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.newpassword.required"
                  >Your password is required.</small
                >
              }

              @if (registerForm.get('password')?.errors?.minlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.newpassword.minlength"
                  >Your password is required to be at least 4 characters.</small
                >
              }

              @if (registerForm.get('password')?.errors?.maxlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.newpassword.maxlength"
                  >Your password cannot be longer than 50 characters.</small
                >
              }
            </div>
          }

          <app-password-strength-bar [passwordToCheck]="registerForm.get('password')!.value"></app-password-strength-bar>
        </div>

        <div class="mb-4">
          <label
            class="block text-surface-900 dark:text-surface-0 font-medium mb-2"
            for="confirmPassword"
            appTranslate="global.form.confirmpassword.label"
            >New password confirmation</label
          >
          <input
            pInputText
            type="password"
            class="w-full"
            id="confirmPassword"
            name="confirmPassword"
            placeholder="{{ 'global.form.confirmpassword.placeholder' | translate }}"
            formControlName="confirmPassword"
            data-cy="secondPassword"
            autocomplete="off"
          />

          @if (
            registerForm.get('confirmPassword')!.invalid &&
            (registerForm.get('confirmPassword')!.dirty || registerForm.get('confirmPassword')!.touched)
          ) {
            <div>
              @if (registerForm.get('confirmPassword')?.errors?.required) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.confirmpassword.required"
                  >Your confirmation password is required.</small
                >
              }

              @if (registerForm.get('confirmPassword')?.errors?.minlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.confirmpassword.minlength"
                  >Your confirmation password is required to be at least 4 characters.</small
                >
              }

              @if (registerForm.get('confirmPassword')?.errors?.maxlength) {
                <small
                  class="text-surface-600 dark:text-surface-200 font-medium leading-loose"
                  appTranslate="global.messages.validate.confirmpassword.maxlength"
                  >Your confirmation password cannot be longer than 50 characters.</small
                >
              }
            </div>
          }
        </div>

        <p-button
          type="submit"
          [disabled]="registerForm.invalid"
          class="w-full"
          icon="pi pi-user"
          data-cy="submit"
          label="{{ 'register.form.button' | translate }}"
        ></p-button>
      </form>
    }
  </div>
</div>
